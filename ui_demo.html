<!DOCTYPE html>
<html theme=dark>
<head>
<style>
* {
	box-sizing: border-box;
}
</style>
</head>
<body>
<script src=glue.js global extend></script>
<script src=ui.js></script>
<script src=validation.js></script>
<script src=ui_nav.js></script>
<script src=ui_grid.js></script>
<script>

let pr = console.log

let tuts = []
let demos = []

demos.grid = `
ui.grid('g1')
`

tuts.text = `
// text() shows a line of text.

// how to call it: text(id, text, fr=1,
//      align='center', valign='center',
//      max_min_w=inf, min_w='auto', min_h='auto'
//   )

// max_min_w limits how much text can expand under min_w='auto' before being clipped.
// the id is optional, we'll get back to that.

ui.text('', 'Hello World!')
`

tuts.h = `
// h() is a flexbox-like container that places its children horizontally.

// how to call it: ui.h(fr=1, gap=0, align='stretch', valign='stretch', min_w=0, min_h=0)

ui.h()
	ui.text('', 'Hello')
	ui.text('', 'World')
ui.end()
`

tuts.v = `
// v() is a flexbox-like container that places its children vertically.

// how to call it: ui.v(fr=1, gap=0, align='stretch', valign='stretch', min_w=0, min_h=0)

ui.v()
	ui.text('', 'Hello')
	ui.text('', 'World')
ui.end()
`

tuts.stack = `
// stack() is a container that places its children on top of each other,
// expanding as needed to make them fit.

// how to call it: ui.stack(id, fr=1, align='stretch', valign='stretch', min_w=0, min_h=0)

ui.stack()
	ui.text('', 'Hello')
	ui.text('', 'World')
ui.end()
`

tuts.bb = `
// bb() puts a background and/or border on its container, which is usually a stack.

// how to call it: bb(id, bg_color, border_sides, border_color, border_radius=0)
//    border_sides can be true or 1 (all), null (none), or any combination of 'ltrb'.
//    bg_color and border_color can be null (none).

// ui.shadow() draws a box shadow on the next bb() call.

ui.stack('', 0, 'c', 'c', 150, 50)
	ui.shadow(2, 2, 5, 0, false, 'black')
	ui.bb('', 'crimson', 'ltrb', 'brown', 10)
	ui.text('', 'Hello World!')
ui.end()
`

tuts.font_size = `
// font(), font_size(), font_weight(), color() can be used
// to style up the text in the current container.

ui.v(0, 20, 'c', 'c')
	ui.font_size(24)
	ui.color('teal')
	ui.text('', 'Buongiorno!')
	ui.h(0, 10, 'c')
		// font and color changes are scoped.
		// when this container ends, previus settings take effect.
		ui.font('Serif')
		ui.font_size(42)
		ui.font_weight('bold')
		ui.color('green')
		ui.text('', 'Hello', 0)
		ui.text('', 'World!', 0)
	ui.end()
	// using the font size set above in this scope.
	ui.text('', 'Buona notte!')
ui.end()
`

demos.flex_align_gap = `
ui.v(1, 30, 'c', 'c')

	ui.h(1, 10, 'c', 'c')
	for (let align of ['l', 'r', 'c', 's']) {
		ui.v(1, 10)
		for (let valign of ['t', 'b', 'c', 's']) {
			ui.h(1, 10, 'c', 'c', 30, 30)
				ui.bb('bg3', null, 1, 'intense')
				for (let i = 1; i <= 3; i++) {
					ui.stack('', 1, align, valign, 10, 10)
						ui.bb('', 'red')
					ui.end_stack()
				}
			ui.end()
		}
		ui.end()
	}
	ui.end()

	ui.h(1, 10, 'c', 'c')
	for (let align of ['l', 'r', 'c', 's']) {
		ui.v(1, 10)
		for (let valign of ['t', 'b', 'c', 's']) {
			ui.v(1, 10, 'c', 'c', 30, 30)
				ui.bb('', null, 1, 'intense')
				for (let i = 1; i <= 3; i++) {
					ui.stack('', 1, align, valign, 10, 10)
						ui.bb('', 'red')
					ui.end_stack()
				}
			ui.end()
		}
		ui.end()
	}
	ui.end()

ui.end()
`

demos.flex_fr_min_w = `
ui.h(1, 30)
for (let hv of ['h', 'v']) {
	ui.hv(hv, 1, 10, 'c', 'c', 100, 100)
		ui.stack('', 1)
			ui.bb('', 'red')
		ui.end_stack()
		ui.stack('', 2)
			ui.bb('', 'red')
		ui.end_stack()
		ui.stack('', 3)
			ui.bb('', 'red')
		ui.end_stack()
		ui.stack('', 4)
			ui.bb('', 'red')
		ui.end_stack()
		ui.stack('', 0, 's', 's', 100, 100)
			ui.bb('', 'red')
		ui.end_stack()
	ui.end()
}
ui.end_h()
`

demos.split = `
ui.hsplit('hsplit1', .5)
		ui.vsplit('vsplit1')
				ui.hsplit('hsplit2', 100, 'px')
						ui.text('', 'Fixed')
					ui.splitter()
						ui.text('', 'Mobile')
				ui.end_hsplit()
			ui.splitter()
				ui.hsplit('hsplit3', 0.3)
						ui.text('', '30%')
					ui.splitter()
						ui.text('', '70%')
				ui.end_hsplit()
		ui.end_vsplit()
	ui.splitter()
		ui.vsplit('vsplit2')
				ui.hsplit('hsplit4', 200, 'px', ']')
						ui.text('', 'Mobile')
					ui.splitter()
						ui.text('', 'Fixed')
				ui.end_hsplit()
			ui.splitter()
				ui.hsplit('hsplit5', 0.3)
						ui.text('', '30%')
					ui.splitter()
						ui.text('', '70%')
				ui.end_hsplit()
		ui.end_vsplit()
ui.end_hsplit()
`

demos.word_wrap = `
ui.hsplit('hsplit1', .8)
		ui.v()

			ui.p(20)
			ui.stack()
				ui.bb('', 'bg2')
				ui.text_wrapped('text1', \`
					Were we in a Garden of Eden where land and other goods were infinitely
					abundant, there would be no scarcity and, therefore, no need
					for property rules; property concepts would be meaningless. The idea
					of conflict, and the idea of rights, would not even arise. For example,
					your taking my lawnmower would not really deprive me of it if I
					could conjure up another in the blink of an eye. Lawnmower-taking
					in these circumstances would not be theft. Property rights are not
					applicable to things of infinite abundance, because there cannot be
					conflict over such things.
				\`, 0, 'c')
			ui.end_stack()

			ui.p(20)
			ui.stack()
				ui.bb('', 'bg1')
				ui.text_wrapped('text2', \`
					The wrapped text pushes this flex cell down.
				\`, 0, 'l')
			ui.end_stack()

			ui.p(20)
			ui.stack()
				ui.bb('', 'bg2')
				ui.text_wrapped('text3', \`
					The wrapped text pushes this flex cell down.
					Also, this is right-aligned.
				\`, 0, 'r')
			ui.end_stack()

		ui.end_v()
	ui.splitter()
		ui.stack()
			ui.text('', '<- Drag to wrap')
		ui.end_stack()
ui.end_hsplit()
`

demos.input = `
ui.v(1, ui.sp(), 'l', 'c')
	ui.h(1, ui.sp())
		ui.label('input1', 'First Input')
		ui.input('input1', 'Hello3 Hello3 Hello3 Hello3')
	ui.end_h()
	ui.h(1, ui.sp())
		ui.label('input2', 'Second Input')
		ui.input('input2', 'Hello3 Hello3')
	ui.end_h()
ui.end_v()
`

demos.bg_dots = `
ui.bg_dots('dots1', 0.3)
`

demos.button = `
ui.m(ui.sp2())
ui.h(1, ui.sp2(), 's', 't')
	if (ui.button_primary('btn1', 'Click me!'))
		pr('clicked btn1!')
	if (ui.button('btn2', 'Click me too!'))
		pr('clicked btn2!')
ui.end_h()
`

demos.popup = `
ui.m(20)
ui.v(1, 10, 'c', 'c')
	let i = 1
	for (let inner of ['', 'i']) {
		ui.h(1, 0, 'c', 'c', 200, 100)
			ui.bb('', null, 1, 'gray')
			for (let align of ['c', '[', ']']) {
				ui.m(20, 20)
				ui.stack()
					ui.bb('', null, 1, 'gray')
					for (let side of ['t', 'r', 'b', 'l', 'c']) {
						if (side != 'c' || inner) {
							ui.popup('popup'+i++, null, null, inner+side, align, 10, 10)
								ui.bb('', null, 1, 'gray')
							ui.end_popup()
						}
					}
				ui.end_stack()
			}
		ui.end_h()
	}
ui.end_v()
`

demos.bb_tooltip = `
let j = 0
for (let align of ['c', '[', ']']) {
	let i = 0
	for (let side of ['t', 'r', 'b', 'l']) {
		let [x, y, p_i] = ui.drag_point('p'+j+i, 100+j*220, 100+i*120, 'red')
		let ct_i = ui.popup('ttc'+j+i, null, p_i, 'ic', 'c', 30, 30)
			ui.bb('', null, 1, 'light')
			ui.m(
				side == 'l' || side == 'r' ? ui.sp2() : 0,
				side == 't' || side == 'b' ? ui.sp2() : 0,
			)
			ui.popup('tt'+j+i, null, ct_i, side, align, 100, 50, 'change_side constrain')
				ui.shadow(1, 1, 3, 0, false, ui.dark ? 'black' : '#ccc')
				ui.bb_tooltip('', 'bg2', 'intense', ui.sp1())
			ui.end_popup()
		ui.end_popup()
		i++
	}
	j++
}
`

demos.scrollbox = `

ui.v(0, 30, 'c', 'c')

	ui.h(0, 10, 'c', 'c')

		// both scrollbars
		ui.sb('sb1', 0, null, null, 'c', 'c', 100, 100)
			ui.stack('', 0, 'l', 't', 300, 300)
				ui.bb('', 'bg1', 1, 'intense')
			ui.end_stack()
		ui.end_sb()

		// max w/h before showing scrollbar
		ui.sb('sb2', 0, 'scroll', 'scroll', 'c', 'c', 100, 100)
			ui.stack('', 0, 'l', 't', 100, 100)
				ui.bb('', 'bg1', 1, 'intense')
			ui.end_stack()
		ui.end_sb()

		// hide on x-axis
		ui.sb('sb3', 0, 'hide', 'auto', 'c', 'c', 100, 100)
			ui.stack('', 0, 'l', 't', 300, 300)
				ui.bb('', 'bg1', 1, 'intense')
			ui.end_stack()
		ui.end_sb()

		// hide on y-axis
		ui.sb('sb4', 0, 'auto', 'hide', 'c', 'c', 100, 100)
			ui.stack('', 0, 'l', 't', 300, 300)
				ui.bb('', 'bg1', 1, 'intense')
			ui.end_stack()
		ui.end_sb()

	ui.end_h()

	ui.h(0, 10, 'c', 'c')

		// contain on x-axis
		ui.sb('sb5', 0, 'contain', 'auto', 'c', 'c', 100, 100)
			ui.stack('', 0, 'l', 't', 200, 200)
				ui.bb('', 'bg1', 1, 'intense')
			ui.end_stack()
		ui.end_sb()

		// contain on y-axis
		ui.sb('sb5', 0, 'auto', 'contain', 'c', 'c', 100, 100)
			ui.stack('', 0, 'l', 't', 200, 200)
				ui.bb('', 'bg1', 1, 'intense')
			ui.end_stack()
		ui.end_sb()

	ui.end_h()

ui.end_v()
`

demos.toolbox = `
ui.toolbox('tb1', "I am left-aligned", '[', 100, 100)
	ui.stack('', 1, 's', 's', 200, 300)
	ui.end_stack()
ui.end_toolbox()
ui.toolbox('tb2', "I am also left-aligned", '[', 150, 150)
	ui.stack('', 1, 's', 's', 200, 300)
	ui.end_stack()
ui.end_toolbox()
ui.toolbox('tb3', "I am right-aligned", ']', 100, 100)
	ui.stack('', 1, 's', 's', 200, 300)
	ui.end_stack()
ui.end_toolbox()
`

let test_template = {
	t: 'v', fr: 2, gap: 20, e: [
		{t: 'text', id: 't1', s: 'TP Hello!'},
		{t: 'stack', id: 'st1', fr: 1, e: [
			{t: 'bb', id: 'r1', bg_color: 'hsl(120deg 50% 16%)'},
		]},
	]}
demos.template = `
ui.template('tpl1', test_template)
`

demos.color_picker = `
ui.p(ui.sp())
ui.stack('', 0, 'c', 'c', 400)
	ui.bb('', null, 1, 'light')
	ui.color_picker('cp1')
ui.end_stack()
`

let demos_array; {
let t = {}
for (let k in tuts)
	t['tutorial_'+k] = tuts[k]
Object.assign(demos, t)
demos_array = Object.keys(demos)
}

let a_length = 0
let dark_mode = true
ui.frame = function() {

	ui.v()

		ui.p(ui.sp())
		ui.h(0, ui.sp2(), 's')
			ui.bb('', null, 'b', 'light')
			ui.color('label')
			ui.text('', 'max frame', 0)
			ui.color('link')
			ui.text('', (ui.max_frame_duration * 1000).toFixed(1)+' ms', 0, 'r', 'c', 1/0, ui.em(4))
			ui.color('label')
			ui.text('', 'last frame', 0)
			ui.color('link')
			ui.text('', (ui.last_frame_duration * 1000).toFixed(1)+' ms', 0, 'r', 'c', 1/0, ui.em(4))
			ui.color('label')
			ui.text('', 'a.length', 0)
			ui.color('link')
			ui.text('', a_length+'', 0, 'r', 'c', 1/0, ui.em(3))
			if (ui.button('btn_light', 'lights')) {
				dark_mode = !dark_mode
				ui.redraw()
			}
			ui.default_theme = dark_mode ? 'dark' : 'light'
			ui.color('label')
			ui.text('', 'canvas-ui v'+ui.VERSION, 1, 'r')
		ui.end_h()

		ui.h()

			ui.sb('demos_list_sb', .2)
				let demo = ui.list('demos', demos_array)
			ui.end_sb()

			let s = (demos[demo] ?? '').trim()

			ui.sb('demo_code', .5)
				ui.bb('', 'bg1', 'r', 'light')
				ui.font('monospace')
				ui.p(ui.sp4())
				if (s)
					ui.text_lines('demo_text', s, 0, 'l', 't')
			ui.end_sb()

			ui.stack()
				if (s)
					eval(s)
			ui.end_stack()

		ui.end_h()

	ui.end_v()

	a_length = ui.a.length
}

ui.ready()

</script>
</body>
</html>
